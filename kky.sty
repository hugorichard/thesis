\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{mathtools}
\ifx\proof\undefined 
\RequirePackage{amsthm}
\fi
\RequirePackage{bm} 
\RequirePackage{url}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\bbR{\mathbb{R}}
\def\bbE{\mathbb{E}}
\def\loss{\mathcal{L}}
\def\peq{\mathrel{\mathop:}=}
% \DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\Sp}{Sp}

% Bold Alphabet 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\ab}{\boldsymbol{a}}
\newcommand{\bb}{\boldsymbol{b}}
\newcommand{\cbb}{\boldsymbol{c}}
\newcommand{\db}{\boldsymbol{d}}
\newcommand{\eb}{\boldsymbol{e}}
\newcommand{\fb}{\boldsymbol{f}}
\newcommand{\gb}{\boldsymbol{g}}
\newcommand{\hb}{\boldsymbol{h}}
\newcommand{\ib}{\boldsymbol{i}}
\newcommand{\jb}{\boldsymbol{j}}
\newcommand{\kb}{\boldsymbol{k}}
\newcommand{\lb}{\boldsymbol{l}}
\newcommand{\mb}{\boldsymbol{m}}
\newcommand{\nbb}{\boldsymbol{n}}
\newcommand{\ob}{\boldsymbol{o}}
\newcommand{\pb}{\boldsymbol{p}}
\newcommand{\qb}{\boldsymbol{q}}
\newcommand{\rb}{\boldsymbol{r}}
\newcommand{\sbb}{\boldsymbol{s}}
\newcommand{\tb}{\boldsymbol{t}}
\newcommand{\ub}{\boldsymbol{u}}
\newcommand{\vb}{\boldsymbol{v}}
\newcommand{\wb}{\boldsymbol{w}}
\newcommand{\xb}{\boldsymbol{x}}
\newcommand{\yb}{\boldsymbol{y}}
\newcommand{\zb}{\boldsymbol{z}}
% \newcommand{\sb}{\boldsymbol{s}}
\newcommand{\nb}{\boldsymbol{n}}
% Upper case
\newcommand{\Ab}{\boldsymbol{A}}
\newcommand{\Bb}{\boldsymbol{B}}
\newcommand{\Cb}{\boldsymbol{C}}
\newcommand{\Db}{\boldsymbol{D}}
\newcommand{\Eb}{\boldsymbol{E}}
\newcommand{\Fb}{\boldsymbol{F}}
\newcommand{\Gb}{\boldsymbol{G}}
\newcommand{\Hb}{\boldsymbol{H}}
\newcommand{\Ib}{\boldsymbol{I}}
\newcommand{\Jb}{\boldsymbol{J}}
\newcommand{\Kb}{\boldsymbol{K}}
\newcommand{\Lb}{\boldsymbol{L}}
\newcommand{\Mb}{\boldsymbol{M}}
\newcommand{\Nb}{\boldsymbol{N}}
\newcommand{\Ob}{\boldsymbol{O}}
\newcommand{\Pb}{\boldsymbol{P}}
\newcommand{\Qb}{\boldsymbol{Q}}
\newcommand{\Rb}{\boldsymbol{R}}
\newcommand{\Sbb}{\boldsymbol{S}}
\newcommand{\Tb}{\boldsymbol{T}}
\newcommand{\Ub}{\boldsymbol{U}}
\newcommand{\Vb}{\boldsymbol{V}}
\newcommand{\Wb}{\boldsymbol{W}}
\newcommand{\Xb}{\boldsymbol{X}}
\newcommand{\Yb}{\boldsymbol{Y}}
\newcommand{\Zb}{\boldsymbol{Z}}


% Calligraphic fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Acal}{\mathcal{A}}
\newcommand{\Bcal}{\mathcal{B}}
\newcommand{\Ccal}{\mathcal{C}}
\newcommand{\Dcal}{\mathcal{D}}
\newcommand{\Ecal}{\mathcal{E}}
\newcommand{\Fcal}{\mathcal{F}}
\newcommand{\Gcal}{\mathcal{G}}
\newcommand{\Hcal}{\mathcal{H}}
\newcommand{\Ical}{\mathcal{I}}
\newcommand{\Jcal}{\mathcal{J}}
\newcommand{\Kcal}{\mathcal{K}}
\newcommand{\Lcal}{\mathcal{L}}
\newcommand{\Mcal}{\mathcal{M}}
\newcommand{\Ncal}{\mathcal{N}}
\newcommand{\Ocal}{\mathcal{O}}
\newcommand{\Pcal}{\mathcal{P}}
\newcommand{\Qcal}{\mathcal{Q}}
\newcommand{\Rcal}{\mathcal{R}}
\newcommand{\Scal}{{\mathcal{S}}}
\newcommand{\Tcal}{{\mathcal{T}}}
\newcommand{\Ucal}{\mathcal{U}}
\newcommand{\Vcal}{\mathcal{V}}
\newcommand{\Wcal}{\mathcal{W}}
\newcommand{\Xcal}{\mathcal{X}}
\newcommand{\Ycal}{\mathcal{Y}}
\newcommand{\Zcal}{\mathcal{Z}}

% Widely accepted definitions (from MKolar, James & Akshay)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\CC}{\mathbb{C}} % Complex numbers
\newcommand{\DD}{\mathbb{D}} % \mathbb(D) 
\newcommand{\EE}{\mathbb{E}} % Expectation
\newcommand{\VV}{\mathbb{V}} % Variance
\newcommand{\II}{\mathbb{I}} % Indicator
\newcommand{\KK}{\mathbb{K}} % Arbitrary field
\newcommand{\LL}{\mathbb{L}} % Loss
\newcommand{\MM}{\mathbb{M}} % Median
\newcommand{\NN}{\mathbb{N}} % Natural numbers
\newcommand{\PP}{\mathbb{P}} % Probability
\newcommand{\QQ}{\mathbb{Q}} % Rationals
\newcommand{\RR}{\mathbb{R}} % Real numbers
\newcommand{\XX}{\mathbb{X}} %
\newcommand{\YY}{\mathbb{Y}} %
\newcommand{\ZZ}{\mathbb{Z}} % Integers

% Stuff mostly appearing in Statistics
\newcommand{\Xbar}{\bar{X}}
\newcommand{\Ybar}{\bar{Y}}
\newcommand{\Zbar}{\bar{Z}}

% Indicator function
\newcommand{\indfone}{\mathbbm{1}}
\newcommand{\indfI}{I}
% For Covar
\newcommand{\Covar}{\mathbb{C} \mathrm{ov} } % Co-Variance

% Some standard definitions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand*{\mini}{\mathop{\mathrm{minimize}}}
\newcommand*{\maxi}{\mathop{\mathrm{maximize}}}
\newcommand*{\subto}{\mathop{\mathrm{subject}\;\mathrm{to}}}
% repeating these 3 mainly for writing optimization problems
\newcommand*{\minip}{\mathop{\mathrm{minimize}\;\;}}
\newcommand*{\maxip}{\mathop{\mathrm{maximize}\;\;}}
\newcommand*{\subtop}{\mathop{\mathrm{subject}\;\mathrm{to}\;\;}}
% \newcommand*{\argmin}{\mathop{\mathrm{argmin}}}
% \newcommand*{\argmax}{\mathop{\mathrm{argmax}}}
\newcommand{\sgn}{\mathop{\mathrm{sign}}}
\newcommand{\suchthat}{\mathrm{s.t.}}
\newcommand{\tr}{\mathop{\mathrm{tr}}}
% \DeclareMathOperator*{\Var}{{\rm Var}}
\DeclareMathOperator*{\Corr}{Corr}
\DeclareMathOperator*{\Cov}{Cov}
\DeclareMathOperator*{\ind}{1{\hskip -2.5 pt}\hbox{I}}  % Indicator
\newcommand{\smallfrac}[2]{{\textstyle \frac{#1}{#2}}}  

% Upright d for differentials
\newcommand{\ud}{\mathrm{d}}
                                                        
\newcommand*{\zero}{{\boldsymbol{0}}}
\newcommand*{\one}{{\boldsymbol{1}}}

\newcommand*{\Risk}{{\rm Risk}}
\newcommand*{\Bias}{{\rm Bias}}

\newcommand{\pen}{{\rm pen}}
% \newcommand{\diag}{{\rm diag}}
\newcommand{\diam}{{\bf{\rm diam}}}
\newcommand{\spann}{{\bf{\rm span}}}
\newcommand{\nulll}{{\bf{\rm null}}}
\newcommand{\vol}{{\bf{\rm vol}}}

% Other Generic Math stuff 
\newcommand{\rank}{{\bf{\rm rank}}}
\newcommand{\dimension}{{\bf{\rm dim}}}

% Hypographs and Epigraphs
\newcommand{\epi}{{\bf{\rm epi}}\;}
\newcommand{\hypo}{{\bf{\rm hypo}}\;}

% suppport domain etc
%\newcommand{\supp}{{\bf{\rm supp}}\;} % support of a function
\newcommand{\dom}{{\bf{\rm dom}}\;} % domain of a function
\newcommand{\interior}{{\bf{\rm int}}\;} % interior of a set

% Big O notation
\newcommand{\bigO}{\tilde{O}}
\newcommand{\bigOtilde}{\tilde{\mathcal{O}}}
\newcommand{\littleO}{\mathcal{o}}
\newcommand{\bigOmega}{\mathcal{\Omega}}
\newcommand{\littleOmega}{\mathcal{\omega}}

% Distributions
\newcommand{\Bern}{{\bf{\rm Bern}}\,} % support of a function
\newcommand{\Categ}{{\bf{\rm Categ}}\,} % support of a function
\newcommand{\Mult}{{\bf{\rm Mult}}\,} % support of a function
\newcommand{\Dir}{{\bf{\rm Dir}}\,} % support of a function

% derivatives and partial fractions
\newcommand{\differentiate}[2]{ \frac{ \ud #2}{\ud #1} }
\newcommand{\differentiateat}[3]{ \frac{ \ud #2}{\ud #1}  \Big|_{#1=#3} }
\newcommand{\partialfrac}[2]{ \frac{ \partial #2}{\partial #1} }
\newcommand{\partialfracat}[3]{ \frac{ \partial #2}{\partial #1} \Big|_{#1=#3} }
\newcommand{\partialfracorder}[3]{ \frac{ \partial^{#3} #2}{\partial^{#3} #1} }
\newcommand{\partialfracatorder}[4]{ \frac{ \partial^{#3} #2}
  {\partial^{#3} #1} \Big|_{#1=#4} }

% Equal signs
\newcommand{\defeq}{\stackrel{\Delta}{=}}

% probabilistic convergence
\newcommand{\indistribution}{\xrightarrow[]{\Dcal}}
\newcommand{\inprobability}{\xrightarrow[]{\Pcal}}

\def\iid{{i.i.d }}
\newcommand{\iidsim}{\stackrel{{iid}}{\sim}}
\def\bks{\backslash}

% Ceil & Floor
\newcommand{\ceil}[1]{\lceil #1 \rceil}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}

% Sets
\renewcommand{\emptyset}{\varnothing}

% bold greek letters
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand*{\alphab}{\boldsymbol{\alpha}}
\newcommand*{\betab}{\boldsymbol{\beta}}
\newcommand*{\Sigmab}{\boldsymbol{\Sigma}}
\newcommand*{\Omegab}{\boldsymbol{\Omega}}
\newcommand*{\omegab}{{\boldsymbol{\omega}}}
\newcommand*{\Gammab}{\boldsymbol{\Gamma}}
\newcommand*{\Psib}{\boldsymbol{\Psi}}
\newcommand*{\psib}{\boldsymbol{\psi}}
\newcommand*{\Thetab}{\boldsymbol{\Theta}}
\newcommand*{\thetab}{\boldsymbol{\theta}}
\newcommand*{\taub}{\boldsymbol{\tau}}
\newcommand*{\epsilonb}{\boldsymbol{\epsilon}}
\newcommand*{\etab}{\boldsymbol{\eta}}
\newcommand*{\xib}{\boldsymbol{\xi}}
\newcommand*{\gammab}{\boldsymbol{\gamma}}
\newcommand*{\deltab}{\boldsymbol{\delta}}
\newcommand*{\Deltab}{\boldsymbol{\Delta}}
\newcommand*{\mub}{\boldsymbol{\mu}}
\newcommand*{\rhobb}{\boldsymbol{\rho}}
\newcommand*{\Phib}{\boldsymbol{\Phi}}
\newcommand*{\phib}{\boldsymbol{\phi}}
\newcommand*{\grad}{\nabla}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%% Norms %%%%%
\newcommand{\orlnorm}[2]{||#1||_{\Psi_{#2}}}
\newcommand{\norm}[1]{||#1||}
\newcommand{\bignorm}[1]{\bigg|\bigg|#1\bigg|\bigg|}
\newcommand{\opnorm}[2]{| \! | \! | #1 | \! | \! |_{{#2}}}

%%%%% Dot product
\newcommand{\dotp}[2]{\langle{#1},{#2}\rangle}

%%%%  brackets
\newcommand{\inner}[2]{\left\langle #1,#2 \right\rangle}
\newcommand{\rbr}[1]{\left(#1\right)}
\newcommand{\sbr}[1]{\left[#1\right]}
\newcommand{\cbr}[1]{\left\{#1\right\}}
\newcommand{\nbr}[1]{\left\|#1\right\|}
\newcommand{\abr}[1]{\left|#1\right|}


%%%%%%%%%  Other commands
\newcommand{\mcomment}[1]{\marginpar{\tiny{#1}}}
\newcommand{\fcomment}[1]{\footnote{\tiny{#1}}}


%%%%%%%%  amsmath %%%%%%%%%%
% Proofs/ Theorems/ Lemmas etc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifx\BlackBox\undefined
\newcommand{\BlackBox}{\rule{1.5ex}{1.5ex}}  % end of proof
\fi

\ifx\QED\undefined
\def\QED{~\rule[-1pt]{5pt}{5pt}\par\medskip}
\fi

\ifx\proof\undefined
\newenvironment{proof}{\par\noindent{\bf Proof\ }}{\hfill\BlackBox\\[2mm]}
\fi
% Proof Sketch
\ifx\proofsketch\undefined
\newenvironment{proofsketch}{\par\noindent{\bf Proof Sketch\ }}{\hfill\BlackBox\\[2mm]}
\fi

\ifx\theorem\undefined
\newtheorem{theorem}{Theorem}
\fi
\ifx\example\undefined
\newtheorem{example}{Example}
\fi
\ifx\property\undefined
\newtheorem{property}{Property}
\fi
\ifx\lemma\undefined
\newtheorem{lemma}[theorem]{Lemma}
\fi
\ifx\proposition\undefined
\newtheorem{proposition}[theorem]{Proposition}
\fi
\ifx\remark\undefined
\newtheorem{remark}[theorem]{Remark}
\fi
\ifx\corollary\undefined
\newtheorem{corollary}[theorem]{Corollary}
\fi
\ifx\definition\undefined
\newtheorem{definition}[theorem]{Definition}
\fi
\ifx\conjecture\undefined
\newtheorem{conjecture}[theorem]{Conjecture}
\fi
\ifx\fact\undefined
\newtheorem{fact}[theorem]{Fact}
\fi
\ifx\claim\undefined
\newtheorem{claim}[theorem]{Claim}
\fi
\ifx\assum\undefined
\newtheorem{assumption}[theorem]{Assumption}
\fi
\ifx\assum\undefined
\newtheorem{observation}[theorem]{Observation}
\fi


% Colours
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\definecolor{darkblue}{rgb}{0.0,0.0,0.7} % for hyper-links


% Hyperlinks
%\hypersetup{colorlinks,breaklinks, linkcolor=darkblue, urlcolor=darkblue, anchorcolor=darkblue, citecolor=darkblue}
%\providecommand*\url[1]{\href{#1}{#1}} % url
%\renewcommand*\url[1]{\href{#1}{\texttt{#1}}} %url


% Other random stuff
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\horizontalline}{\noindent\rule[0.5ex]{\linewidth}{1pt}}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} 
\newcommand{\Hrule}{\rule{\linewidth}{0.3mm}}
\newcommand{\HRuleN}{\HRule\\} 
\newcommand{\HruleN}{\Hrule\\}
\newcommand{\superscript}[1]{{\scriptsize \ensuremath{^{\textrm{#1}}}}}
\newcommand{\supindex}[2]{#1^{(#2)}}
\newcommand{\xii}[1]{\supindex{\xb}{#1}}
\newcommand{\yii}[1]{\supindex{y}{#1}}
\newcommand{\zii}[1]{\supindex{\zb}{#1}}
\newcommand{\Xii}[1]{\supindex{\Xb}{#1}}
\newcommand{\Wii}[1]{\supindex{\Wb}{#1}}
\newcommand{\Yii}[1]{\supindex{Y}{#1}}
\newcommand{\Zii}[1]{\supindex{Z}{#1}}

\newcommand{\mut}[2]{\mu_{#1}({#2})}
\newcommand{\sigmat}[2]{\sigma_{#1}({#2})}
\newcommand{\tmut}[2]{\tilde{\mu}_{#1}({#2})}
\newcommand{\tyb}{\tilde{\yb}}
\newcommand{\ty}{\tilde{y}}
\newcommand{\tO}{\tilde{O}}
% \newcommand{\tf}{\tilde{f}}
\newcommand{\tz}{\tilde{\zb}}
\newcommand{\tT}{\tilde{T}}
\newcommand{\tx}{\tilde{\xb}}
\newcommand{\sigb}{\boldsymbol{\Sigma}}
\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\txii}[1]{\supindex{\tx}{#1}}

% Equation Numbering - Numbers only one equation in align*, equation*
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}




% project specific
\newcommand{\xbm}{{\boldsymbol{x}}}
\newcommand{\sbm}{{\boldsymbol{s}}}
\newcommand{\ybm}{{\boldsymbol{y}}}
\newcommand{\zbm}{{\boldsymbol{z}}}
\newcommand{\vbm}{{\boldsymbol{v}}}
\newcommand{\Xbm}{{\boldsymbol{X}}}
\newcommand{\Ybm}{{\boldsymbol{Y}}}
\newcommand{\Zbm}{{\boldsymbol{Z}}}
\newcommand{\Vbm}{{\boldsymbol{V}}}
\newcommand{\Xset}{{\set{X}}}
\newcommand{\Yset}{{\set{Y}}}
\newcommand{\Zset}{{\set{Z}}}
\newcommand{\Vset}{{\set{V}}}

\def\-{\raisebox{.75pt}{-}}
\newcommand{\shortminus}{\scalebox{0.75}[1.0]{\( - \)}}
\newcommand{\thetagen}{{\boldsymbol{\theta}^{}_g}}
\newcommand{\thetadopt}{{\boldsymbol{\theta}^*_d}}
\newcommand{\thetagopt}{{\boldsymbol{\theta}^*_g}}
\newcommand{\thetad}{{\boldsymbol{\theta}_d}}
\newcommand{\thetade}{{\boldsymbol{\theta}_d^e}}
\newcommand{\thetadd}{{\boldsymbol{\theta}_d^d}}
% \newcommand{\supp}{{\mathrm{supp}}}
\newcommand{\vj}{{\boldsymbol{v}_j}}
\newcommand{\vjs}{{\{\boldsymbol{v}_j\}_{j=1}^J}}
\newcommand{\allparams}{{(\boldsymbol{\theta}_g, \boldsymbol{\theta}_d, \boldsymbol{V})}}
\newcommand{\allparamsours}{{(\boldsymbol{\theta}_g, \set{V})}}
\newcommand{\yvbm}{{\boldsymbol{yv}}}
\newcommand{\vybm}{{\boldsymbol{vy}}}
\newcommand{\vxbm}{{\boldsymbol{vx}}}
\newcommand{\xvbm}{{\boldsymbol{xv}}}
\newcommand{\xybm}{{\boldsymbol{xy}}}
\newcommand{\yxbm}{{\boldsymbol{yx}}}
\newcommand{\thetabm}{{\boldsymbol{\theta}}}
\newcommand{\omegabm}{{\boldsymbol{\omega}}}


\newcommand{\exvj}{{\boldsymbol{e}_{\boldsymbol{xv}}^j}}
\newcommand{\eyvj}{{\boldsymbol{e}_{\boldsymbol{yv}}^j}}

\newcommand*{\tran}{^{\mkern-1.5mu\mathsf{T}}}
%\newcommand{\dim}{{\mathrm{dim}}}
